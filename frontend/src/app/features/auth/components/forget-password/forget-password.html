<div class="modal-header">
  <h4 class="modal-title">Récupération de mot de passe </h4>
  <button type="button" class="btn-close" (click)="modalService.dismissAll()"></button>
</div>

<div class="modal-body">
  <div class="register-container">
    <!-- Formulaire à gauche -->
    <div class="register-form-section">
      <div class="register-header">
        <h5 class="register-subtitle">Vous avez oublié votre mot de passe ? Commencez par nous dire l'email de récupération . </h5>
      </div>
      <!-- Message d'erreur -->
      <div *ngIf="showError" class="alert alert-danger alert-dismissible fade show" role="alert">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 8px;">
          <circle cx="12" cy="12" r="10"/>
          <line x1="12" y1="8" x2="12" y2="12"/>
          <line x1="12" y1="16" x2="12.01" y2="16"/>
        </svg>
        {{ errorMessage }}
        <button type="button" class="btn-close" (click)="showError = false"></button>
      </div>

      <form class="register-form" (ngSubmit)="onSubmit($event)">
        <div class="form-group">
          <label for="email">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
              <polyline points="22,6 12,13 2,6"/>
            </svg>
            Email
          </label>
          <input
            type="email"
            id="email"
            class="form-control"
            [(ngModel)]="user.email"
            name="email"
            placeholder="votre@email.com"
            [class.is-invalid]="user.email.length > 0 && !isEmailValid()"
            [class.is-valid]="user.email.length > 0 && isEmailValid()"
            required
          >
          <div *ngIf="user.email.length > 0 && !isEmailValid()" class="invalid-feedback">
            Veuillez entrer une adresse email valide
          </div>
        </div>

        <button
          type="submit"
          class="btn btn-success w-100 mt-4"
          [disabled]="!isFormValid() || isSubmitting"
        >
          <span *ngIf="!isSubmitting">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/>
              <polyline points="10 17 15 12 10 7"/>
              <line x1="15" y1="12" x2="3" y2="12"/>
            </svg>
           Envoi de code
          </span>
          <span *ngIf="isSubmitting">
            <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
            Envoi de code  en cours...
          </span>
        </button>
      </form>

      <div class="login-link">
        <p>Vous vous souvenez de votre mot de passe ? <a (click)="openConnexion()" style="cursor: pointer;">Se connecter</a></p>
      </div>
    </div>
  </div>
</div>

<div class="modal-footer">
  <button class="btn btn-outline-secondary" (click)="modalService.dismissAll()">Fermer</button>
</div>
